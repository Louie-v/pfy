/*-----------------------------This for Yezi---------------------------------*/
//first build data:2013-8-27
// Ê¹ÓÃÁ¬Ðø¶Ë¿Ú£¬Î´Ê¹ÓÃÖÐ¶Ï
/*1 28
1+2 27
2+3 26
3+4 25+in3
4+5 24+in2
5+6 23+in1
7 22
8 21
159 20
1610 19+14
6+11 18+13
7+12 17+12
8+13 16+11
9+1415+10
*/
/* I/O: DDRD(11111111)=0xFF Ê¹ÓÃ8Î»
DDRB(XX111111)=0xff Ê¹ÓÃ6Î»
DDRC(XXXXX000)=0x00 Ê¹ÓÃ3Î» ÊäÈë
*/
/*-----------------------------This is end---------------------------------*/


#include <avr/io.h>
// #include <interrupt.h>
// #include <avr/signal.h>
#include <util/delay.h>

//////////////////////////////////////////////////////////////////////////////////////////////////////

const uint16_t data0[] =
    {
// 32*6=192
0x40,0x00,0x40,0x42,0x44,0x22,0x44,0x12,
0x54,0x0A,0x64,0x42,0x45,0x82,0xC6,0x7F,
0x44,0x02,0x64,0x02,0x54,0x0A,0x44,0x12,
0x44,0x22,0x40,0x42,0x40,0x00,0x00,0x00,/*"亲",0*/

0x00,0x00,0x00,0x00,0x00,0x58,0x00,0x38,
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,/*"，",1*/

0x80,0x40,0x40,0x40,0x30,0x42,0x1E,0x42,
0x10,0x42,0x10,0x42,0x10,0x42,0xFF,0x7F,
0x10,0x42,0x10,0x42,0x10,0x42,0x10,0x42,
0x10,0x42,0x10,0x40,0x00,0x40,0x00,0x00,/*"生",0*/

0x00,0x00,0x00,0x00,0x00,0x00,0xFE,0xFF,
0x82,0x40,0x82,0x40,0x82,0x40,0x82,0x40,
0x82,0x40,0x82,0x40,0x82,0x40,0xFE,0xFF,
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,/*"日",1*/

0x00,0x01,0xE0,0x00,0x00,0x00,0xFF,0xFF,
0x10,0x00,0x20,0x81,0x08,0x41,0x08,0x31,
0x08,0x0D,0xFF,0x03,0x08,0x0D,0x08,0x31,
0xF8,0x41,0x00,0x81,0x00,0x81,0x00,0x00,/*"快",2*/

0x00,0x00,0x00,0x20,0xE0,0x10,0x9C,0x08,
0x84,0x06,0x84,0x40,0x84,0x80,0xF4,0x7F,
0x82,0x00,0x82,0x00,0x83,0x02,0x82,0x04,
0x80,0x08,0x80,0x30,0x00,0x00,0x00,0x00,/*"乐",3*/
    };

const uint16_t data1[] =
    {
        // 32*5=160
0x20,0x00,0x24,0x08,0x24,0x48,0x24,0x84,
0xFE,0x7F,0x23,0x02,0x22,0x41,0x20,0x40,
0x20,0x20,0xFF,0x13,0x20,0x0C,0x22,0x14,
0x2C,0x22,0xA0,0x41,0x20,0xF8,0x00,0x00,/*"我",0*/

0x00,0x01,0x80,0x00,0x60,0x00,0xF8,0xFF,
0x07,0x00,0x00,0x00,0xF8,0xFF,0x01,0x00,
0x06,0x00,0x00,0x00,0x04,0x00,0x04,0x40,
0x04,0x80,0xFC,0x7F,0x00,0x00,0x00,0x00,/*"们",1*/

0x00,0x00,0x02,0x02,0xF2,0x82,0x92,0x92,
0x92,0x9A,0xFE,0x56,0x92,0x63,0x92,0x22,
0x92,0x32,0xFE,0x4A,0x92,0x46,0x92,0x42,
0xF2,0x82,0x02,0x02,0x00,0x00,0x00,0x00,/*"要",2*/

0x20,0x08,0x20,0x08,0x24,0x09,0x24,0x09,
0x64,0x09,0xA4,0x09,0x24,0x09,0x3F,0xFF,
0x24,0x09,0xA4,0x09,0x64,0x09,0x24,0x09,
0x24,0x09,0x20,0x08,0x20,0x08,0x00,0x00,/*"幸",3*/

0x08,0x02,0x09,0x01,0xCE,0xFF,0xB8,0x00,
0x08,0x03,0x00,0x00,0x02,0xFF,0x7A,0x49,
0x4A,0x49,0x4A,0x49,0x4A,0x7F,0x4A,0x49,
0x4A,0x49,0x7A,0x49,0x02,0xFF,0x00,0x00,/*"福",4*/
    };
const uint16_t data2[] =
    {
        // 32*5=160
0x00,0x88,0x00,0x68,0x3E,0x09,0x22,0x09,
0x2A,0x29,0x32,0xC9,0x22,0x09,0xFE,0x0F,
0x22,0x29,0x32,0xC9,0x2A,0x09,0x22,0x09,
0x3E,0x29,0x00,0xC8,0x00,0x08,0x00,0x00,/*"黑",0*/

0x00,0x80,0x00,0x60,0xFE,0x1F,0x02,0x00,
0x12,0x20,0x22,0x10,0xC2,0x0C,0x02,0x03,
0xC2,0x0C,0x32,0x30,0x02,0x00,0xFE,0x0F,
0x00,0x30,0x00,0x40,0x00,0xF8,0x00,0x00,/*"风",1*/

0x10,0x04,0x10,0x03,0xD0,0x00,0xFF,0xFF,
0x90,0x00,0x10,0x11,0x00,0x08,0x10,0x04,
0x10,0x03,0xD0,0x00,0xFF,0xFF,0xD0,0x00,
0x10,0x03,0x10,0x04,0x10,0x08,0x00,0x00,/*"林",2*/

0x00,0x00,0x10,0x20,0x10,0x20,0xF8,0x3F,
0x00,0x20,0x00,0x20,0x00,0x00,0x00,0x00,/*"1",3*/

0x00,0x00,0x30,0x18,0x08,0x20,0x88,0x20,
0x88,0x20,0x48,0x11,0x30,0x0E,0x00,0x00,/*"3",4*/

0x00,0x00,0x10,0x20,0x10,0x20,0xF8,0x3F,
0x00,0x20,0x00,0x20,0x00,0x00,0x00,0x00,/*"1",5*/

0x00,0x00,0x00,0x07,0xC0,0x04,0x20,0x24,
0x10,0x24,0xF8,0x3F,0x00,0x24,0x00,0x00,/*"4",6*/
    };
//uint8_t count=(sizeof(data)/sizeof(data[0]));//Êý¾Ý³¤¶È£¬ÔÝÊ±²»ÓÃ

//////////////////////////////////////////////////////////////////////////////////////////////////////

//////////////////////////////////////////////////////////////////////////////////////////////////////

void display(uint8_t dis_date1, uint8_t dis_date2) ///ÏÔÊ¾º¯Êý
{

    //------------------ÏÔÊ¾-------------------//
    PORTD = dis_date1;
    PORTB = dis_date2;
    _delay_ms(1);///////////////////////视觉控制///////////////////////////////////
    //------------------ÏûÓ°-------------------//
    PORTD = 0x00;
    PORTB = 0x00;
}
//////////////////////////////////////////////////////////////////////////////////////////////////////

//////////////////////////////////////////////////////////////////////////////////////////////////////
void blink(void)
{
    PORTD = _BV(0);
    _delay_ms(100);
    PORTD = 0x00;
    _delay_ms(100);
}
//////////////////////////////////////////////////////////////////////////////////////////////////////

//////////////////////////////////////////////////////////////////////////////////////////////////////
void port_init(void) ///¶Ë¿Ú³õÊ¼»¯º¯Êý£¬¹²Ê¹ÓÃ19¸ö¶Ë¿Ú 16¸öÊä³ö3¸öÊäÈë
{
    DDRB = 0xFF; ///Ê¹ÓÃPB0~5,¹²6¸ö
    DDRC = 0x00; ///Ê¹ÓÃPC0~1£¬¹²2¸ö
    PORTC = _BV(DDC3) | _BV(DDC4) | _BV(DDC5); //ÊäÈëÉèÖÃ
    DDRD = 0xFF; ///Ê¹ÓÃPD0~7£¬¹²8¸ö

    _delay_ms(300);
    for (int i = 0; i < 6; ++i)
    {
        blink();
    }



}

//////////////////////////////////////////////////////////////////////////////////////////////////////
/*
 
// ISR(INT0_vect)///Íâ²¿ÖÐ¶Ïº¯Êý0///·´ÏòÏÔÊ¾
// {
// for (int i = count; i >= 0; i-=2)
// {
// display(data[i-1],data[i]);
// _delay_ms(2);
// }
// }
 
 
 
// ISR(INT1_vect)///Íâ²¿ÖÐ¶Ïº¯Êý1///ÕýÏòÏÔÊ¾
// {
 
// for (int i = 0; i <= count; i+=2)
// {
// display(data[i],data[i+1]);
// _delay_ms(2);
// }
// }
*/

//////////////////////////////////////////////////////////////////////////////////////////////////////


int main(void)
{
    port_init();
    // MCUCR&=0xf0;
    //GICR=_BV(INT1)|_BV(INT1);
    // sei();
    uint8_t list = 1;
    while (1)
    {

            if (!(PINC&0x20))
            {
                _delay_ms(20);
                while (!(PINC&0x20));

                list++;
                if (list > 4)
                {
                    list = 1;
                }

            }
            if (list == 1) ////////////////////ÏÔÊ¾Êý¾Ý1//////////////////////////////////////
            {
                if (!(PINC&0x08))
                {
                    _delay_ms(20);
                    while (!(PINC&0x08));

                    for (int i = 0; i < 192; i++) ////////jÏÔÊ¾Êý¾Ý³¤¶È////////////////
                    {
                        display(data0[i], data0[i + 1]);
                        i++;
                    }

                }
                if (!(PINC&0x10))
                {
                    _delay_ms(20);
                    while (!(PINC&0x10));

                    for (int i = 191; i >= 0; i--) ////////jÏÔÊ¾Êý¾Ý³¤¶È////////////////
                    {
                        display(data0[i - 1], data0[i]);
                        i--;
                    }

                }
            }
            if (list == 2) ////////////////////ÏÔÊ¾Êý¾Ý2//////////////////////////////////////
            {
                if (!(PINC&0x08))
                {
                    _delay_ms(20);
                    while (!(PINC&0x08));

                    for (int i = 0; i < 160; i++) ////////jÏÔÊ¾Êý¾Ý³¤¶È////////////////
                    {
                        display(data1[i], data1[i + 1]);
                        i++;
                    }

                }
                if (!(PINC&0x10))
                {
                    _delay_ms(20);
                    while (!(PINC&0x10));

                    for (int i = 159; i >= 0; i--) ////////jÏÔÊ¾Êý¾Ý³¤¶È////////////////
                    {
                        display(data1[i - 1], data1[i]);
                        i--;
                    }

                }
            }
            if (list == 3) ////////////////////ÏÔÊ¾Êý¾Ý3//////////////////////////////////////
            {
                if (!(PINC&0x08))
                {
                    _delay_ms(20);
                    while (!(PINC&0x08));

                    for (int i = 0; i < 160; i++) ////////jÏÔÊ¾Êý¾Ý³¤¶È////////////////
                    {
                        display(data2[i], data2[i + 1]);
                        i++;
                    }

                }
                if (!(PINC&0x10))
                {
                    _delay_ms(20);
                    while (!(PINC&0x10));

                    for (int i = 159; i >= 0; i--) ////////jÏÔÊ¾Êý¾Ý³¤¶È////////////////
                    {
                        display(data2[i - 1], data2[i]);
                        i--;
                    }

                }
            }
    }
    return 0;
}

/////////////////////////////////////////////////////////////////////////////////////////////////////